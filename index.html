
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MIXPELIS</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#000000" />
  <link rel="apple-touch-icon" href="assets/icon.png" />
  <link rel="stylesheet" href="css/styles.css" />

  <!-- Estilos para los avisos -->
  <style>
    #installPrompt,
    #iosPrompt {
      position: fixed;
      bottom: 15px;
      left: 15px;
      right: 15px;
      background: gold;
      color: black;
      padding: 12px 16px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      z-index: 9999;
      font-size: 14px;
      line-height: 1.4em;
    }

    #installPrompt button {
      background: black;
      color: gold;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-left: 10px;
    }

    #iosPrompt {
      background: white;
      color: black;
    }

    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <header>
    <h1>MIXPELIS</h1>
  </header>

  <main>
    <section class="bubbles">
      <button class="bubble" data-category="accion">ACCIÓN</button>
      <button class="bubble" data-category="terror">TERROR</button>
      <button class="bubble" data-category="drama">DRAMA</button>
      <button class="bubble" data-category="comedia">COMEDIA</button>
      <button class="bubble" data-category="infantiles">INFANTILES</button>
    </section>
    <section id="movie-list" class="movie-list"></section>
  </main>

  <footer>
    <p>&copy; 2025 MIXPELIS</p>
  </footer>

  <!-- Burbuja para Android y PC -->
  <div id="installPrompt" class="hidden">
    <span>¿Quieres instalar MIXPELIS?</span>
    <button id="installBtn">Descargar App</button>
  </div>

  <!-- Aviso para iPhone/Mac Safari -->
  <div id="iosPrompt" class="hidden">
    <p><strong>¿Quieres instalar esta app?</strong><br>
    En Safari, presiona <strong>Compartir</strong> 
    (<img src="https://img.icons8.com/ios-filled/20/000000/share.png" style="vertical-align:middle;" />)
    y elige <strong>“Agregar a pantalla de inicio”</strong>.</p>
  </div>

  <!-- Tu JS principal -->
  <script defer src="js/app.js"></script>

  <!-- Script para detección e instalación -->
  <script>
    // Registrar Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }

    // Mostrar aviso de instalación en Android y PC
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installPrompt')?.classList.remove('hidden');
    });

    document.getElementById('installBtn')?.addEventListener('click', () => {
      document.getElementById('installPrompt').classList.add('hidden');
      if (deferredPrompt) {
        deferredPrompt.prompt();
      }
    });

    // Mostrar aviso para iOS/Mac Safari
    const isIOS = /iphone|ipad|ipod|macintosh/i.test(navigator.userAgent);
    const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;

    if (isIOS && isSafari && !isStandalone) {
      document.getElementById('iosPrompt')?.classList.remove('hidden');
    }
  </script>
</body>
</html>